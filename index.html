<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Form Laporan Keuangan ‚Äî Simple</title>
<style>
  :root{
    --accent: #99b7d5;
    --bg: #f8fafc;
    --card: #ffffff;
    --muted: #6b7280;
    --radius: 12px;
    --shadow: 0 6px 18px rgba(15,23,42,0.06);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    background:linear-gradient(180deg, #fbfdff 0%, var(--bg) 100%);
    color:#0f172a;
    padding:24px;
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
  }

  .container{
    width:100%;
    max-width:760px;
    background:var(--card);
    border-radius:18px;
    padding:24px;
    box-shadow:var(--shadow);
  }

  h1{margin:0 0 8px;font-size:20px}
  p.lead{margin:0 0 18px;color:var(--muted);font-size:13px}

  form.row{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }
  @media(max-width:640px){form.row{grid-template-columns:1fr}}

  .field{display:flex;flex-direction:column;}
  label{font-size:12px;color:var(--muted);margin-bottom:6px;}
  input[type="text"],input[type="number"],textarea,.select,.searchable{
    border:1px solid #e6e9ef;
    padding:10px 12px;
    border-radius:10px;
    font-size:15px;
    transition:box-shadow .18s ease,transform .12s ease;
  }
  input:focus,textarea:focus,.select:focus,.searchable:focus{
    box-shadow:0 6px 18px rgba(153,183,213,0.12);
    border-color:var(--accent);
  }
  textarea{min-height:64px;resize:vertical;}

  .full{grid-column:1/-1;}
  .row-inline{display:flex;gap:8px;align-items:center;justify-content:flex-end}
  .btn{
    width:100%;
    padding:12px 16px;
    border-radius:10px;
    background:linear-gradient(180deg,var(--accent),#8fb0c9);
    color:white;
    border:none;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 6px 18px rgba(153,183,213,0.12);
    transition:background .2s ease;
  }
  .btn:hover{background:linear-gradient(180deg,#a2c1df,#89abc8);}
  .hint{font-size:12px;color:var(--muted);margin-top:8px;}
  footer.small{text-align:center;margin-top:14px;font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="container">
  <h1>Form Laporan Keuangan</h1>
  <p class="lead">Masukkan transaksi ‚Äî simple dan mobile friendly.</p>

  <form id="laporForm" class="row" autocomplete="off">
    <!-- tanggal -->
    <div class="field full">
      <label for="tanggal">Tanggal</label>
      <input type="date" id="tanggal" name="tanggal" required>
    </div>

    <!-- keterangan -->
    <div class="field full">
      <label for="keterangan">Keterangan</label>
      <textarea id="keterangan" name="keterangan" placeholder="Contoh: Beli makan siang / Transport ke kantor" required></textarea>
    </div>

    <!-- kategori utama -->
    <div class="field">
      <label for="kategoriUtama">Kategori Utama</label>
      <select id="kategoriUtama" class="select">
        <option value="">Pilih kategori utama</option>
        <option value="PENDAPATAN">PENDAPATAN</option>
        <option value="KEBUTUHAN">KEBUTUHAN</option>
        <option value="KEINGINAN">KEINGINAN</option>
        <option value="LAINNYA">LAINNYA</option>
        <option value="SIMPANAN">SIMPANAN</option>
      </select>
    </div>

    <!-- kategori detail -->
    <div class="field">
      <label for="kategoriDetail">Kategori Detail</label>
      <input id="kategoriDetail" name="kategori" list="kategoriList" placeholder="Ketik atau pilih" required>
      <datalist id="kategoriList"></datalist>
    </div>

    <!-- total -->
    <div class="field full">
      <label for="total">Total (Rp)</label>
      <input id="total" name="total" type="number" min="0" placeholder="0" required>
    </div>

    <!-- submit -->
    <div class="field full">
      <button type="submit" class="btn">Kirim</button>
    </div>
  </form>

  <footer class="small">üí∏ Data akan dikirim ke Google Sheet tab <b>üí∏CASHFLOW</b></footer>
</div>

<script>
/* =========================
   KONFIGURASI
   ========================= */
const API_URL = "https://script.google.com/macros/s/AKfycbxoSdJxK2AftPCw8tyFtJJEqLFRB0YeJ-hSMXQT23PK2zj_TD16XHRVPWZ2ghazOQ8TdA/exec"; // GANTI dengan Web App kamu

const CATEGORIES = {
  "PENDAPATAN":["Gaji","Ortu/Mertua","Reimburse Greenway","Piutang","INC 4","INC 5"],
  "KEBUTUHAN":["Mamin","Cicilan","Tagihan","Iuran","Transportasi","Hana","Sembako","Maintenance","Kesehatan"],
  "KEINGINAN":["Shoping","Healing","Kredit","Jajan","Sedekah"],
  "LAINNYA":["Bon Greenway","Admin","Buwuh"],
  "SIMPANAN":["Simpanan","Darurat","Investasi"]
};

/* =========================
   INISIALISASI
   ========================= */
document.addEventListener("DOMContentLoaded",()=>{
  const tgl = document.getElementById("tanggal");
  const today = new Date().toISOString().split("T")[0];
  tgl.value = today;

  const utama = document.getElementById("kategoriUtama");
  const list = document.getElementById("kategoriList");

  utama.addEventListener("change",()=>{
    list.innerHTML="";
    const arr = CATEGORIES[utama.value] || [];
    arr.forEach(k=>{
      const opt=document.createElement("option");
      opt.value=k;
      list.appendChild(opt);
    });
  });
});

/* =========================
   SUBMIT FORM
   ========================= */
document.getElementById("laporForm").addEventListener("submit",async(e)=>{
  e.preventDefault();
  const btn = e.target.querySelector("button[type=submit]");
  btn.disabled = true;
  btn.textContent = "Mengirim...";

  const data = {
    tanggal: document.getElementById("tanggal").value,
    keterangan: document.getElementById("keterangan").value.trim(),
    kategori: document.getElementById("kategoriDetail").value.trim(),
    total: document.getElementById("total").value
  };

  try{
    const res = await fetch(API_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(data)
    });
    const text = await res.text();
    if(!res.ok) throw new Error(text);
    alert("‚úÖ Data berhasil dikirim!");
    e.target.reset();
    document.getElementById("tanggal").value = new Date().toISOString().split("T")[0];
  }catch(err){
    console.error(err);
    alert("‚ö†Ô∏è Gagal mengirim data.\nPastikan Web App URL benar dan diatur: 'Anyone, even anonymous'.");
  }finally{
    btn.disabled = false;
    btn.textContent = "Kirim";
  }
});
</script>
</body>
</html>
