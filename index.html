<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Form Laporan Keuangan Bani Hayat</title>
<style>
  :root{
    --accent: #3b82f6;
    --bg: #f9fbfd;
    --card: #ffffff;
    --muted: #6b7280;
    --radius: 14px;
    --shadow: 0 6px 18px rgba(0,0,0,0.06);
    font-family: 'Inter', system-ui, sans-serif;
  }

  *{box-sizing:border-box;margin:0;padding:0;}

  body{
    background: var(--bg);
    color:#0f172a;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:0;
  }

  .container{
    width:100%;
    max-width:900px;
    background:var(--card);
    border-radius:0;
    box-shadow:var(--shadow);
    padding:20px 20px 40px;
    min-height:100vh;
  }

  @media(min-width:768px){
    .container{
      border-radius: var(--radius);
      margin:24px;
      min-height:auto;
    }
  }

  header{
    text-align:center;
    margin-bottom:24px;
  }

  h1{
    font-size:22px;
    font-weight:700;
    margin-bottom:6px;
  }

  p.lead{
    color:var(--muted);
    font-size:14px;
  }

  form.row{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    gap:16px;
  }

  .field{display:flex;flex-direction:column;}
  label{font-size:13px;color:var(--muted);margin-bottom:6px;font-weight:500;}

  input, textarea, select{
    border:1px solid #e5e7eb;
    border-radius:10px;
    padding:12px;
    font-size:15px;
    transition:all .2s ease;
    width:100%;
  }

  input:focus,textarea:focus,select:focus{
    outline:none;
    border-color:var(--accent);
    box-shadow:0 0 0 3px rgba(59,130,246,0.1);
  }

  textarea{resize:vertical;min-height:70px;}

  .full{grid-column:1/-1;}

  .btn{
    width:100%;
    padding:14px 16px;
    border-radius:10px;
    background:var(--accent);
    color:white;
    border:none;
    font-weight:600;
    cursor:pointer;
    font-size:16px;
    transition:all .25s ease;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
  }

  .btn:hover{background:#2563eb;}
  .btn:disabled{opacity:0.7;cursor:not-allowed;}

  /* Spinner loading */
  .spinner{
    border:3px solid #e5e7eb;
    border-top:3px solid white;
    border-radius:50%;
    width:16px;
    height:16px;
    animation:spin 1s linear infinite;
  }
  @keyframes spin{to{transform:rotate(360deg)}}

  footer{
    text-align:center;
    margin-top:28px;
    font-size:13px;
    color:var(--muted);
  }

  /* Toast */
  .toast{
    position:fixed;
    bottom:20px;
    left:50%;
    transform:translateX(-50%) translateY(30px);
    background:#0f172a;
    color:white;
    padding:10px 18px;
    border-radius:8px;
    opacity:0;
    transition:all .3s ease;
    z-index:9999;
  }
  .toast.show{
    opacity:1;
    transform:translateX(-50%) translateY(0);
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>Form Laporan Keuangan</h1>
    <p class="lead">Catat transaksi keuangan dengan mudah ‚Äî mobile friendly.</p>
  </header>

  <form id="laporForm" class="row" autocomplete="off">
    <!-- tanggal -->
    <div class="field full">
      <label for="tanggal">Tanggal</label>
      <input type="date" id="tanggal" name="tanggal" required>
    </div>

    <!-- keterangan -->
    <div class="field full">
      <label for="keterangan">Keterangan</label>
      <textarea id="keterangan" name="keterangan" placeholder="Contoh: Beli makan siang / Transport ke kantor" required></textarea>
    </div>

    <!-- kategori utama -->
    <div class="field">
      <label for="kategoriUtama">Kategori Utama</label>
      <select id="kategoriUtama" class="select" required>
        <option value="">Pilih kategori utama</option>
        <option value="PENDAPATAN">üí∞ Pendapatan</option>
        <option value="KEBUTUHAN">üì¶ Kebutuhan</option>
        <option value="KEINGINAN">üéÅ Keinginan</option>
        <option value="LAINNYA">üßæ Lainnya</option>
        <option value="SIMPANAN">üè¶ Simpanan</option>
      </select>
    </div>

    <!-- kategori detail -->
    <div class="field">
      <label for="kategoriDetail">Kategori Detail</label>
      <select id="kategoriDetail" class="select" required>
        <option value="">Pilih kategori detail</option>
      </select>
    </div>

    <!-- total -->
    <div class="field full">
      <label for="total">Total (Rp)</label>
      <input id="total" name="total" type="number" min="0" placeholder="0" required>
    </div>

    <!-- submit -->
    <div class="field full">
      <button type="submit" class="btn">
        <span>Kirim</span>
      </button>
    </div>
  </form>

  <footer>üí∏ Data akan dikirim ke Google Sheet tab <b>üí∏CASHFLOW</b></footer>
</div>

<div class="toast" id="toast"></div>

<script>
/* =========================
   KONFIGURASI
   ========================= */
const API_URL = "https://script.google.com/macros/s/AKfycbxoSdJxK2AftPCw8tyFtJJEqLFRB0YeJ-hSMXQT23PK2zj_TD16XHRVPWZ2ghazOQ8TdA/exec";

const CATEGORIES = {
  "PENDAPATAN":["Gaji","Ortu/Mertua","Reimburse Greenway","Piutang","Bonus","Lainnya"],
  "KEBUTUHAN":["Makan & Minum","Cicilan","Tagihan","Iuran","Transportasi","Kesehatan","Sembako"],
  "KEINGINAN":["Belanja","Hobi","Healing","Kredit Barang","Sedekah"],
  "LAINNYA":["Bon Greenway","Admin","Buwuh","Tak Terduga"],
  "SIMPANAN":["Simpanan","Dana Darurat","Investasi"]
};

/* =========================
   INISIALISASI
   ========================= */
document.addEventListener("DOMContentLoaded",()=>{
  const tgl=document.getElementById("tanggal");
  const today=new Date().toISOString().split("T")[0];
  tgl.value=today;

  const utama=document.getElementById("kategoriUtama");
  const detail=document.getElementById("kategoriDetail");

  utama.addEventListener("change",()=>{
    detail.innerHTML='<option value="">Pilih kategori detail</option>';
    const arr=CATEGORIES[utama.value]||[];
    arr.forEach(k=>{
      const opt=document.createElement("option");
      opt.value=k;
      opt.textContent=k;
      detail.appendChild(opt);
    });
  });
});

/* =========================
   TOAST FUNCTION
   ========================= */
function showToast(msg, success=true){
  const toast=document.getElementById("toast");
  toast.textContent=msg;
  toast.style.background=success?"#16a34a":"#dc2626";
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),3000);
}

/* =========================
   SUBMIT FORM
   ========================= */
document.getElementById("laporForm").addEventListener("submit",async e=>{
  e.preventDefault();
  const btn=e.target.querySelector("button[type=submit]");
  const span=btn.querySelector("span");
  span.textContent="Mengirim...";
  const spinner=document.createElement("div");
  spinner.className="spinner";
  btn.prepend(spinner);
  btn.disabled=true;

  const data={
    tanggal:document.getElementById("tanggal").value,
    keterangan:document.getElementById("keterangan").value.trim(),
    kategori:document.getElementById("kategoriDetail").value.trim(),
    total:document.getElementById("total").value
  };

  try{
    await fetch(API_URL,{
      method:"POST",
      mode:"no-cors",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(data)
    });

    showToast("‚úÖ Data berhasil dikirim!");
    e.target.reset();
    document.getElementById("tanggal").value=new Date().toISOString().split("T")[0];
  }catch(err){
    console.error(err);
    showToast("‚ö†Ô∏è Gagal mengirim data.",false);
  }finally{
    btn.disabled=false;
    spinner.remove();
    span.textContent="Kirim";
  }
});
</script>
</body>
</html>
